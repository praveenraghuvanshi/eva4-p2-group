service: sentimentanalysis

provider:
    name: aws
    runtime: python3.8
    stage: dev
    region: ap-south-1
    timeout: 60
    versionFunctions: false

    environment:
        MODEL_BUCKET_NAME: eva4p2bucket1
        MODEL_FILE_NAME_KEY: s9_wordembeddings.pt
        MODEL_FILE_OBJ: s9_wordemb_text_vocab_1.pkl
    iamRoleStatements:
        - Effect: "Allow"
          Action:
            - s3:getObject
          Resource: arn:aws:s3:::eva4p2bucket1/*
custom:
    pythonRequirements:
        dockerizePip: true
        zip: true
        slim: true
        strip: false
        noDeploy:
            - docutils
            - jmespath
            - pip
            - python-dateutil
            - setuptools
            - six
            - tensorboard
        useStaticCache: true
        useDonwloadCache: true
        cacheLocation: "./cache"
        
package:
    individually: false
    exclude:
        - package.json
        - package-log.json
        - node_modules/**
        - cache/**
        - test/**
        - __pycache__/**
        - .pytest_cache/**
        - model/**
        
functions:
    main_handler:
        handler: handler.cnn_sentiment_pred
        memorySize: 3008
        timeout: 60
        events:
            - http:
                path: nlp
                method: post
                cors: true

plugins:
  - serverless-python-requirements
